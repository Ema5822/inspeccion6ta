<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Generador de Servicios â€“ Arroyo Seco</title>
<style>
body{font-family:Arial,sans-serif;background:#f4f6f8;padding:20px}
button{padding:8px 14px;margin:4px;cursor:pointer}
.box{background:#fff;padding:15px;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,.1);margin-top:15px}
pre{white-space:pre-wrap}
</style>
</head>
<body>

<h1>ğŸ“‹ Generador semanal de servicios</h1>

<label>ğŸ“… Fecha sÃ¡bado: <input type="date" id="fechaSabado"></label><br><br>
<button id="btnGenerar">Generar servicio</button>
<button id="btnLimpiar">Limpiar historial</button>

<div class="box">
<pre id="resultado"></pre>
</div>

<div class="box">
<h3>ğŸ—‚ Historial</h3>
<div id="historial"></div>
</div>

<script>
const subCrias=[7,9,10,11,12];
let semana=0;
let historial=[];

const guardado=localStorage.getItem("historialServicios");
if(guardado){historial=JSON.parse(guardado);renderHistorial();}

function obtenerFechaServicio(t){
const m=t.match(/Fecha de inicio: (\d{2}\/\d{2}\/\d{4})/);
if(!m)return null;
const[d,mn,a]=m[1].split("/");
return new Date(a,mn-1,d);
}

function renderHistorial(){
const h=document.getElementById("historial");
h.innerHTML="";
historial.sort((a,b)=>obtenerFechaServicio(a)-obtenerFechaServicio(b));
historial.forEach((t,i)=>{
const d=document.createElement("div");
d.className="box";
d.innerHTML=`<pre>${t}</pre>
<button onclick="editarServicio(${i})">âœï¸ Editar</button>
<button onclick="eliminarServicio(${i})">ğŸ—‘ Eliminar</button>`;
h.appendChild(d);
});
localStorage.setItem("historialServicios",JSON.stringify(historial));
}

function generarServicio(){
const f=document.getElementById("fechaSabado").value;
if(!f)return alert("ElegÃ­ una fecha");
const d=new Date(f+"T00:00");
if(d.getDay()!=6)return alert("Debe ser sÃ¡bado");

const txt=d.toLocaleDateString("es-AR");
if(historial.some(h=>h.includes(txt)))
return alert("âš ï¸ Servicio ya creado");

const texto=`SERVICIO
Fecha de inicio: ${txt}`;
document.getElementById("resultado").textContent=texto;
historial.push(texto);
renderHistorial();
}

function editarServicio(i){
const n=prompt("Editar servicio:",historial[i]);
if(!n)return;
const f=obtenerFechaServicio(n);
if(!f)return alert("Fecha invÃ¡lida");
if(historial.some((h,x)=>x!=i&&obtenerFechaServicio(h)?.getTime()==f.getTime()))
return alert("Fecha repetida");
historial[i]=n;
renderHistorial();
}

function eliminarServicio(i){
if(confirm("Eliminar servicio?")){
historial.splice(i,1);
renderHistorial();
}
}

function limpiarHistorial(){
if(confirm("Borrar todo?")){
historial=[];
localStorage.clear();
renderHistorial();
document.getElementById("resultado").textContent="";
}
}
</script>
</body>
</html>
