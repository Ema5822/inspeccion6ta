<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Generador de Servicios ‚Äì Arroyo Seco</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f4f6f8; padding:20px }
    h1 { color:#1f2937 }
    button { padding:10px 16px; font-size:16px; cursor:pointer }
    .box { background:#fff; padding:15px; border-radius:8px; box-shadow:0 2px 6px rgba(0,0,0,.1); margin-top:15px }
    pre { white-space:pre-wrap }
    label { font-weight: bold }
  </style>
</head>
<body>

<h1>üìã Generador semanal de servicios</h1>
<p>Funciona 100% local. El historial queda guardado aunque cierres el navegador.</p>

<label>üìÖ Fecha s√°bado: <input type="date" id="fechaSabado"></label><br><br>
<button id="btnGenerar">Generar servicio semanal</button>
<button id="btnLimpiar">Limpiar historial</button>

<div class="box">
  <pre id="resultado"></pre>
</div>

<div class="box">
  <h3>üóÇ Historial de semanas</h3>
  <pre id="historial"></pre>
</div>

<script>
// ===============================
// CONFIGURACI√ìN
// ===============================
const subCrias = [7, 9, 10, 11, 12];
let semana = 0;
let historial = [];

// ===============================
// CARGAR HISTORIAL GUARDADO
// ===============================
const historialGuardado = localStorage.getItem('historialServicios');
const semanaGuardada = localStorage.getItem('semanaServicios');

if (historialGuardado) {
  historial = JSON.parse(historialGuardado);
  document.getElementById('historial').textContent = historial.join('\n\n------------------------------\n\n');
}

if (semanaGuardada) {
  semana = parseInt(semanaGuardada, 10);
}

// ===============================
// EVENTOS
// ===============================
document.getElementById('btnGenerar').addEventListener('click', generarServicio);
document.getElementById('btnLimpiar').addEventListener('click', limpiarHistorial);

// ===============================
// FUNCI√ìN PRINCIPAL
// ===============================
function generarServicio() {
  const fechaInput = document.getElementById('fechaSabado').value;

  if (!fechaInput) {
    alert('Por favor, seleccion√° la fecha del s√°bado.');
    return;
  }

  const f = new Date(fechaInput + 'T00:00:00');

  // Validar que sea s√°bado (6)
  if (f.getDay() !== 6) {
    alert('La fecha seleccionada no es s√°bado. Por favor eleg√≠ un d√≠a s√°bado.');
    return;
  }

  const opciones = { day: '2-digit', month: '2-digit', year: 'numeric' };
  const fechaSabadoTexto = f.toLocaleDateString('es-AR', opciones);

  // Calcular domingo autom√°ticamente
  const domingo = new Date(f);
  domingo.setDate(domingo.getDate() + 1);
  const fechaDomingoTexto = domingo.toLocaleDateString('es-AR', opciones);

  // Rotaci√≥n de Sub Cr√≠as
  const rotada = subCrias.slice(semana).concat(subCrias.slice(0, semana));

  const sabado = rotada[0];
  const domingoManana1 = rotada[1];
  const domingoManana2 = rotada[2];
  const domingoNoche = rotada[3];
  const descansa = rotada[4];

  const texto = `‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†
SERVICIO CUSTODIA DE INSPECTORES DE TR√ÅNSITO Y GUM EN ARROYO SECO
Fecha de inicio: ${fechaSabadoTexto}
Jurisdicci√≥n de Comisar√≠a 27
Presentaci√≥n calle Libertad y Don Orione ‚Äì A. Seco (S.P.A.)

üìå D√≠a S√ÅBADO (${fechaSabadoTexto}) ‚Äì 01 a 07 hs
A CARGO DEL SERVICIO: Controlador nocturno
Dependencia designada:
Cr√≠a 27 ‚Äì 01 efectivo
Sub Cr√≠a ${sabado} ‚Äì 01 efectivo

üìå D√≠a DOMINGO (${fechaDomingoTexto}) ‚Äì 01 a 07 hs
A CARGO DEL SERVICIO: Controlador nocturno
Dependencia designada:
Sub Cr√≠a ${domingoManana1} ‚Äì 01 efectivo
Sub Cr√≠a ${domingoManana2} ‚Äì 01 efectivo

üìå D√≠a DOMINGO (${fechaDomingoTexto}) ‚Äì 20 a 02 hs
A CARGO DEL SERVICIO: Controlador nocturno
Dependencia designada:
CREAS ‚Äì 01 efectivo
Sub Cr√≠a ${domingoNoche} ‚Äì 01 efectivo

‚û° Descansa esta semana: Sub Cr√≠a ${descansa}
‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†‚ö†`;

  document.getElementById('resultado').textContent = texto;

  historial.push(`SEMANA ${historial.length + 1}\n${texto}`);
  document.getElementById('historial').textContent = historial.join('\n\n------------------------------\n\n');

  // Guardar en localStorage
  localStorage.setItem('historialServicios', JSON.stringify(historial));

  semana = (semana + 1) % subCrias.length;
  localStorage.setItem('semanaServicios', semana.toString());
}

function limpiarHistorial() {
  if (confirm('¬øSeguro que quer√©s borrar todo el historial?')) {
    historial = [];
    semana = 0;
    localStorage.removeItem('historialServicios');
    localStorage.removeItem('semanaServicios');
    document.getElementById('historial').textContent = '';
    document.getElementById('resultado').textContent = '';
  }
}
</script>

</body>
</html>
